# 貿易に関するデータ流通に関連する技術

## アセットトラッキング

貿易において輸送物の追跡に関する技術は最も根本的な技術要素である。

### 輸送物の位置情報を高頻度で取得する方法

電波信号発信機が発信する電波信号を利用する。

#### 電波信号受信機の位置を割り出す方法

* GPS:  GPS衛星が発信する電波信号を受信した電波信号受信機が自らの位置を算出する
* Wi-Fi: 大きく2つの方式がある
    1. Wi-Fiアクセスポイントからの電波信号を受信した電波信号受信機が電波信号を発信したWi-FiアクセスポイントのMacアドレスを予め登録されているWi-Fiアクセスポイント位置情報データベースに照会して位置情報を取得する
    1. 複数のWi-Fiアクセスポイントからの電波信号を受信した電波信号受信機が電波強度や電波信号到達時間などの違いから三点測位を演算する
* BLE: 複数のビーコン発信機からの電波信号を受信した電波信号受信機が電波強度や電波信号到達時間などの違いから三点測位を演算する
* セルラー基地局: セルラー基地局電波信号を受信した電波信号受信機が取得したCell ID(CID)、Location Area Code (LAC)、Mobile Country Code (MCC)、Mobile Network Code(MNC)を予め登録されているセルラー基地局位置情報データベースに照会して位置情報を取得する

#### 位置が割り出された電波信号受信機と対象物を関連つける方法

* 対象物と電波信号受信機を一体化する
* 電波信号受信機が対象物に貼付されたRFIDやNFCなどの個体識別情報を読み込む
* 画像解析により対象物の個体識別特徴点を取得する

### データ転送方法

IoTにおいて位置情報などの物理的な情報を取得するフィジカル空間と、物理的な情報を集約して様々な処理を施すサイバー空間とのデータ転送は必須である。

#### 無線通信方式

IoTシステムは従来のITシステムとは異なり、システムを構成するデバイスが大量且つ様々なロケーションに散財するため、利用される通信方式の殆どが無線通信を前提としている。

頻繁に利用される無線通信方式はスマートフォンやIoTゲートウェイデバイスが利用しやすい2.4GHz帯の規格と、2.4GHz帯より広範囲の通信を可能にする920MHz帯の規格の2つに分けられる。

* 2.4GHz帯を利用する通信方式: 代表的な通信方式としてWi-Fi、Bluetooth/BLE、Zigbeeなどがあり、2.4GHz付近の電波周波数帯を利用した短・中距離通信方式で、多くの国で無線局免許不要なため最も手軽に利用できる通信方式である
* 920MHz帯を利用する通信方式: 代表的な通信方式としてLPWA（LoRaWAN、Sigfox、NB-IoT）、EnOcean、Z-Wave、Wi-SUNなどがあり、920MHz付近の電波周波数帯を利用した中・長距離通信方式で、多くの国で無線局免許不要だが、多くのデバイスが効率的に帯域を利用するために帯域制限を設ける運用ルールが定められている国もある

#### ネットワークプロトコル

IoTシステムで利用される無線通信方式のうちインターネット・プロトコル・スイートに含まれる方式はWi-Fiのみで、その他の通信方式から取得されるデータは独自プロトコルに従ったデータ形式なため、デバイスが所在するロケーションに配置されたスマートフォンやIoTゲートウェイデバイス内のソフトウェアによって、インターネット・プロトコル・スイートに属するプロトコルに従ったデータ形式へ変換されることが多い。

IoTで主に利用されるインターネット・プロトコル・スイートに属する代表的なプロトコルにはHTTPとMQTTがある。

* HTTP: 元々はHTMLなどのコンテンツの送受信に用いられる通信プロトコルで、非常にシンプルで汎用性が高かったためIoTでも利用されることも多いが、リクエストとレスポンスの双方に必ずメッセージヘッダを付与する必要があり、転送コストが増大することを防ぐ場合には避けられる傾向にある
* MQTT: メッセージ指向ミドルウェアのアプリケーション層で使用される、TCP/IPによるPub/Sub型データ配信モデルの軽量なデータ配信プロトコルで、メッセージが軽量に抑えられる仕様となっていることと、到達保証レベルを指定できるQoSという仕様も含まれる
* UDP: 明確なハンドシェイクを省いたコネクションレスであり、送達確認などを行わない言わば無手順方式のデータ転送で、信頼性・順序性・データ完全性を保証しないため、データ送信のみを行い到達確認が不要の場合に採用されることがある

#### データフロー

IoTシステムは将来的に新たな価値が発生する不確実性を考慮して、どの時点においてもデータフローに対して必要な変更を容易に行える状態を継続的に保つ必要がある。

データフローはプロトコルの差異に起因するデータ形式の変換、様々なロケーションのデータの集約、AI推論モデルの学習データとしてのインプット、AI推論モデルの判断が必要なデータの引き渡し、スマートコントラクトに必要なデータの引き渡し、様々なデータストレージへのデータの引き渡しなどで利用される。

* プロトコルの差異に起因するデータ形式の変換: 主にインターネット・プロトコル・スイートに含まれないプロトコルに従ったデータ形式をインターネット・プロトコル・スイートに含まれるプロトコルに従ったデータ形式へ変換する
* 様々なロケーションのデータの集約: 一定の範囲での傾向を掴むために範囲内のロケーションから取得されたデータを集約する
* AI推論モデルの学習データとしてのインプット: AI推論モデルを継続的に学習させるために継続的に学習用データをインプットする
* AI推論モデルの判断が必要なデータの引き渡し: AI推論モデルの判断が必要なデータをAI推論モデルへ転送する
* スマートコントラクトに必要なデータの引き渡し: スマートコントラクトの自動執行に必要なデータをスマートコントラクトへ転送する
* 様々なデータストレージへのデータの引き渡し: 様々なデータストレージへデータを転送する

### データ蓄積方法

IoTで取得されるデータは、その特性として殆どのデータが時系列のビッグデータであるため、データ取得時にデータの活用方法が見出だせていない場合であっても、将来の技術革新によりデータに新たな価値が見出だせる可能性を考慮して、どの時点においても取得したデータに対して必要な加工が可能な状態で継続的に蓄積する必要がある。

#### データウェアハウス

#### データレイク

#### 分散型台帳

### データ活用方法

IoTで取得されるデータは、その特性として殆どのデータが時系列のビッグデータであるため、データ活用の前段にMapReduceによる並列コンピューティングによるバッチ処理を行い、そこで構造化されたデータをAI推論モデルの学習データとして利用し、そのAI推論モデルをストリームデータ処理やスマートコントラクトの判断部分に利用することが考えられる。

#### MapReduce

#### AI推論モデルの学習

#### ストリームデータ処理

#### スマートコントラクト

### デバイス状態管理方法

IoTシステムは従来のITシステムとは異なり、システムを構成するデバイスが大量且つ様々なロケーションに散財しており、それぞれのデバイスが物理的にもネットワーク的にも脆弱な環境に置かれている可能性が高い上に、IoTシステムは前述したIoTシステムとIoTデータ活用の不確実性のために変更用意性も備える必要がある。

そのため、それぞれのデバイスとデバイス内のソフトウェアが現在どういう状態にあるか常に把握するだけでなく、遠隔地から適切なタイミングでデバイスに命令したり、適切なソフトウェアへ更新する必要がある。

#### デバイス状態操作

#### デバイス状態監視

#### デバイス状態履歴

### デバイスセキュリティ及び監査

IoTデバイスは物理的にもネットワーク的にも脆弱な環境に置かれている可能性が高いにも関わらず、デバイスが取得するデータはAI推論モデルの学習に使われたり、分散型台帳に記帳されてスマートコントラクトが自動執行されたりするため、現実世界で起きた真実のデータであるという担保がなされなければ将来的に様々な問題を引き起こす。

具体的な対策としてはトランスポートセキュリティ、デバイスアイデンティティ、ソフトウェア監査の3点が考えられる。

#### トランスポートセキュリティ

デバイスから転送されるデータが改竄されていないことを保証するしくみ。

* TLS: 

#### デバイスアイデンティティ

#### ソフトウェア監査

デバイスアイデンティティによって成りすましは回避できるとしても、デバイス内のソフトウェアが改竄されることより不正なデータが転送される可能性を残すため、デバイス内のソフトウェアの状態を継続的に監査する必要がある。

* 申告先分散型台帳: 継続的にデバイスのソフトウェアのハッシュ値を記帳する分散型台帳で、この分散型台帳に記帳されたデータを監査することでデバイスの監査を実現する
* 申告クライアント: デバイス内のソフトウェアを定期的にハッシュ化し、申告先分散型台帳へ記帳するクライアントソフトウェア
* Trusted Execution Environment: デバイス内のソフトウェアの状態を申告する申告クライアント自体の改竄を防ぐための仕様で、実装としてはArm TrustZone、Intel SGX、Secure Elementなどがある
